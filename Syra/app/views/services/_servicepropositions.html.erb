<div class="panel panel-default">
        <div class="panel-heading">
        	        
        <% if @service.user == current_user %>
			<i class="fa fa-bar-chart-o fa-fw"></i> Les propositions
			<% @lesServices = @service.propositions %>
        <% else %>
        	<i class="fa fa-bar-chart-o fa-fw"></i> Mes propositions
        	<% @lesServices = @service.propositions.where(:user => current_user) %>
        <% end %>
        </div>
        <!-- /.panel-heading -->
        <div class="panel-body">
          <div class="row">
            <div class="col-lg-4">
              <div class="table-responsive">
              <% if @lesServices.size>0 %>
                <table class="table table-bordered table-hover table-striped">
                  <thead>
                    <tr>
                      <th>#</th>
                      <th>Utilisateur</th>
                      <th>Etat</th>
                      <th></th>
                    </tr>
                  </thead>
                  <tbody>
                    <% @lesServices.each do |prop| %>
                    
                    <div class="modal fade" id="modalRefus<%= prop.id %>" tabindex="-1" role="dialog" aria-labelledby="modalRefusLabel" aria-hidden="true">
				        <div class="modal-dialog">
				         <div class="modal-content">
				            <div class="modal-header">
				                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				                <h4 class="modal-title" id="modalRefusLabel">Refuser la proposition <%= prop.id %> de <%= prop.user.name %></h4>
				            </div>
				            <div class="modal-body">
				            	<%= form_for prop, :url => url_for(:controller => 'services', :action => 'refuserProp'), :html => { :class => 'form-horizontal', :role => 'form'}, method: :get do |f| %>
								Motif de refus :
								<%= f.hidden_field :id, value: prop.id %>
								<%= f.text_area :motifCancelled, :class => 'form-control' %>
				            </div>
				            <div class="modal-footer">
				            	<%= f.submit 'Refuser', :class => 'btn btn-danger' %>
				            	<% end %>
				                <button type="button" class="btn btn-primary" data-dismiss="modal">Fermer</button>
				            </div>
				         </div>
				        </div>
				    </div>
				    <% if not @service.isGiven? and current_user.money < prop.price %>
					    <div class="modal fade" id="modalAccepter<%= prop.id %>" tabindex="-1" role="dialog" aria-labelledby="modalAccepterLabel" aria-hidden="true">
					        <div class="modal-dialog">
					         <div class="modal-content">
					            <div class="modal-header">
			                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			                        <h4 class="modal-title" id="myModalLabel">Action impossible ...</h4>
			                    </div>
			                    <div class="modal-body">
			                    	 	Votre solde (<%= current_user.money %>hp) est insuffisant(<%= prop.price %>hp).
			                    </div>
			                    <div class="modal-footer">
			                        <button type="button" class="btn btn-primary" data-dismiss="modal">Fermer</button>
			                    </div>
					         </div>
					        </div>
					    </div>
  					<% end %>
                    <tr>
                      <td><%= prop.id %></td>
                      <td><%= link_to prop.user.name,user_path(prop.user) %></td>
                      <td>
                        <% if prop.isAccepted == nil %>
                            En attente
                        <% elsif prop.isAccepted == false %>
                            Refusée
                        <% else %>
                            Acceptée
                        <% end %>
                      </td>
                      <td><%= link_to 'Voir', proposition_path(prop), {:class=>"btn-link"} %> 
                      <% if @service.user == current_user %>
	                      <% if prop.isAccepted.nil? %>
	                      	<% if not @service.isGiven? and current_user.money < prop.price %>
	                      	<button class="btn-link" data-toggle="modal" data-target="#modalAccepter<%= prop.id %>">Accepter</button>
	                      	<% else %>
	                        	<%= link_to 'Accepter', accepter_prop_service_path(@service, :prop => prop), {:class=>"btn-link"} %>
	                        <% end %>
	                        <button class="btn-link" data-toggle="modal" data-target="#modalRefus<%= prop.id %>">Refuser</button>
	                        <%= # link_to 'Refuser', refuser_prop_service_path(@service, :prop => prop) 
	                        %>
	                      <% end %>
	                  <% else %>
		                  <% if prop.isAccepted.nil? %>
		                  	<%= link_to 'Supprimer',
			                      proposition_path(prop),
			                      :method => :delete,
			                      :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Êtes-vous sûr?')) },
			                      :class => 'btn-link' %>
			              <% end %>
	                  <% end %>
                      </td>
                    </tr>
                    <% end %>
                  </tbody>
                </table>
              <% else %>
                Aucune proposition
              <% end %>
              </div>
              <!-- /.table-responsive -->
            </div>
            <!-- /.col-lg-4 (nested) -->
            <div class="col-lg-8">
            <div id="morris-bar-chart"></div>
            </div>
            <!-- /.col-lg-8 (nested) -->
          </div>
          <!-- /.row -->
        </div>
        <!-- /.panel-body -->
      </div>
      <!-- /.panel -->