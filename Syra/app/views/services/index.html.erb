
  <% content_for :head do %>
    <%= javascript_include_tag "jquery.min" %>
    <%= javascript_include_tag "jquery-ui.min" %>
    <%= javascript_include_tag "googlemap" %>
  	<%= javascript_include_tag "mapservices" %>
    <%= stylesheet_link_tag 'service' %>
  <% end %>
  

<%- model_class = Service -%>
<div class="page-header">
  <h1><%=t '.title', :default => model_class.model_name.human.pluralize.titleize %></h1>
</div>


<%= search_form_for @q, url: index_services_path, html: {:method => 'get'} do |f| %>
  <div class="row">
    <div class="col-md-1"></div>
    <div class="col-md-4"> Titre du service :
      <%= f.text_field :title_or_description_cont %>
      <%= f.submit "rechercher", :id => "recherche", :class => 'btn btn-primary'%>
    </div>

    <div class="col-md-2">
       <a id="avanced" class="btn btn-info"> Recherche avancée </a>
    </div>
  </div>
  <div id="avancedparams">
    <div class="row">
    <div class="col-xs-1 .col-sm-1"></div>
    <div class="col-xs-2 .col-sm-3 ">
      <div class="row">
        <div class="col-md-1"></div>
        </br><div class="col-md-3"> Catégorie </div>
      </div>
      <% @categories = Category.find(:all) 
        @categories.each do |cat| %>
      <div class="row">
        <div class="col-md-1"></div>
        <div class="col-md-3 checkbox">
          <label>
            <input type="checkbox" value="">
              <%= cat.name %>
          </label>
        </div>
      </div>
      <% end %> 
   </div>

  <div class="col-xs-2 .col-sm-3">
    </br>
    <div><b> Lieu : </b></div><br/>
    <br/><b><a id="regionB">Région </a></b>
    <div id="region">
      <div><b> Region : </b></div><br/>
      <SELECT name="region" size="1">
        <OPTION>Peu importe
        <OPTION>Nord-Pas-De-Calais
        <OPTION>Picardie
        <OPTION>PACA
      </SELECT>
    </div>

    <br/> <br/><B><a id="villeB">Ville</a></B>

    <div id="ville">
        <div><b> Ville : </b></div><br/>
        <input type:"text"></input>  
    </div>
      

  </div>

  <div class ="col-xs-6 .col-sm-2">
    </br><div><b>Prix :</b></div><br/>
    <div id="bornes_prix">De <span id="prix_min"></span> à <span id="prix_max"></span> HP</div>
    <div class="row">
      <div id="slider_prix" class="col-md-3"></div>
    </div>
    <br/>
    <br/>
    <div class="row">
      <div class ="col-md-2">
        <%= f.submit "rechercher", :class => 'btn btn-primary' %>
      </div>
      <div class="col-md-5">
        <a id="avancedClose" class="btn btn-warning"> Fermez la recherche avancée </a>
      </div>
    </div>
  </div>
</div>
</div>
<% end %>

<script>
$("#avanced").click(function() {
  $( this ).css({
    cursor: "wait"
  });
  $( "#avancedClose" ).css("cursor", "pointer" );
  $( "#avancedparams" ).slideDown( "fast", function() {
    $("#recherche").hide();
    $( "#avanced" ).hide();
    $( "#avancedClose" ).show();
  });
});

$("#avancedClose").click(function() {
  $( this ).css({
    cursor: "wait"
  });
  $( "#avanced" ).css("cursor", "pointer" );
  $( "#avancedparams" ).slideUp( "fast", function() {
    $("#recherche").show();
    $( "#avancedClose" ).hide();
    $( "#avanced" ).show();
  });
});

$("#regionB").click(function() {
  $( this ).css({
    cursor: "wait"
  });
  $("#regionB").hide();
  if ( $( "#ville" ).is( ":hidden" ) ) {
  } else {
    $( "#ville" ).hide();
    $( "#villeB" ).css("cursor", "pointer" );
    $( "#villeB" ).show();
  }
  $( "#region" ).slideDown( "fast", function() {
  });
});

$("#villeB").click(function() {
  $( this ).css({
    cursor: "wait"
  });
  $("#villeB").hide();
  if ( $( "#region" ).is( ":hidden" ) ) {
  } else {
    $( "#region" ).hide();
    $( "#regionB" ).css("cursor", "pointer" );
    $( "#regionB" ).show();
  }
  $( "#ville" ).slideDown( "fast", function() {
    
    
  });
});

jQuery(document).ready(function($){
    // Création d'un slider dans l'élément id slider_prix
    $("#slider_prix").slider({
        range:  true,
        min:    0,          // valeur min
        max:    1000,       // valeur max
        values: [0, 600],   // position des 2 curseurs à l'initialisation
         
        // Action à effectuer lorsqu'on déplace l'un des curseur
        slide: function(event, ui){
            $('#prix_min').html(ui.values[0]);
            $('#prix_max').html(ui.values[1]);
        }
    });
     
    // Initialisation des valeurs numériques au chargement de la page
    $('#prix_min').html($("#slider_prix").slider("values", 0));
    $('#prix_max').html($("#slider_prix").slider("values", 1));
});
 
</script>


<table class="table table-striped">
  <thead>
    <tr>
      <th>Titre</th>
      <th>Prix (Hp)</th>
      <th><%= model_class.human_attribute_name(:description) %></th>
      <th>Disponibilité</th>
      <th>Mode</th>
      <th>Adresse</th>
      <th>Catégorie</th>
      <th>Utilisateur</th>
      <th><%=t '.actions', :default => t("helpers.actions") %></th>
    </tr>
  </thead>

  <tbody>
  	<% if not @services == nil %>
    <% @services.each do |service| %>
      <tr>
        <td><%= service.title %></td>
        <td><%= service.price %></td>
        <td><%= service.description %></td>
        <td><%= service.disponibility %></td>
        <td>
          <% if service.isGiven=true then %>
            Offre
          <% else %>
            Demande
          <% end %>

        </td>
        
        <td>
		<% if service.address.nil?%>
			 null 
		<% else %>
			<%= service.address.label %>
        <% end %>
    	</td>
    	<td>
    	<% if service.category.nil?%>
			null
		<% else %>
			<a href="<%= category_path(service.category) %>"><%= service.category.name %></a>
        <% end %>
        </td>
        <td>
        <% if service.user.nil?%>
			null
		<% else %>
			<a href="<%= user_path(service.user) %>"><%= service.user.name %> <%= service.user.lastName %></a>
        <% end %>
   	 	</td>
   	 	

        <td>
          <%= link_to 'Voir',
                      service_path(service), :class => 'btn btn-info' %>
          <% if service.user == current_user %>
	          <%= link_to 'Editer',
	                      edit_service_path(service), :class => 'btn btn-warning' %>
	          <%= link_to 'Supprimer',
	                      service_path(service),
	                      :method => :delete,
	                      :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
	                      :class => 'btn btn-mini btn-danger' %>
	     <% end %>
        </td>
      </tr>
    <% end %>
    <% end %>
  </tbody>
</table>
<div class="row">
  <div class="col-md-5"></div>
  <div class="col-md-2">
<%= link_to 'Nouveau Service', 
            new_service_path,
            :class => 'btn btn-primary' %>
            </div>
</div>
          </br>

<% #session[:location] %>
<div id="map">
</div>
